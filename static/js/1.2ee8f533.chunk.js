(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[1],{170:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return c}));var s=r(158),n=r(159),a=(r(265),r(266)),u=r.n(a),i=r(361),o=r.n(i),c=function(){function t(){Object(s.a)(this,t)}return Object(n.a)(t,null,[{key:"getSexText",value:function(e){return"F"===e?"\u5973":"M"===e?"\u7537":"\u5176\u4ed6"}},{key:"isLoged",value:function(){return e.token&&e.token.length>0}},{key:"isValidMobile",value:function(e){return!!/^((\+)?86|((\+)?86)?)0?1[0-9]\d{9}$/.test(e)}},{key:"isEmptyObj",value:function(e){return void 0==e||("string"===typeof e&&0==e.length||"object"===typeof e&&0==Object.keys(e).length)}},{key:"drawCanvas",value:function(e){var t=window.getComputedStyle(e),r=parseInt(t.width,10),s=parseInt(t.height,10),n=1;window.devicePixelRatio&&window.devicePixelRatio>1&&(n=window.devicePixelRatio);var a=n,u=document.createElement("canvas");return u.width=r*a,u.height=s*a,u.style.width="".concat(r,"px"),u.style.height="".concat(s,"px"),u.getContext("2d").scale(a,a),o()(e,{allowTaint:!0,width:r,height:s,useCORS:!0}).then((function(e){return e.toDataURL("image/png")}))}},{key:"safeValueForkey",value:function(e,t,r){return e&&e[t]?e[t]:r}},{key:"encodeBase64",value:function(e){var t,r,s,n,a,u,i,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",f=0;for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var s=e.charCodeAt(r);s<128?t+=String.fromCharCode(s):s>127&&s<2048?(t+=String.fromCharCode(s>>6|192),t+=String.fromCharCode(63&s|128)):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128),t+=String.fromCharCode(63&s|128))}return t}(e);f<e.length;)n=(t=e.charCodeAt(f++))>>2,a=(3&t)<<4|(r=e.charCodeAt(f++))>>4,u=(15&r)<<2|(s=e.charCodeAt(f++))>>6,i=63&s,isNaN(r)?u=i=64:isNaN(s)&&(i=64),c=c+o.charAt(n)+o.charAt(a)+o.charAt(u)+o.charAt(i);return c}},{key:"uuid",value:function(){for(var e=[],t="0123456789abcdef",r=0;r<36;r++)e[r]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var s=e.join("")+(new Date).getTime();return s}},{key:"parseQueryParam",value:function(e){var t={};if(!e||"string"!=typeof e)return t;var r=e.split("?");return r.length<2||r[1].split("&").forEach((function(e){var r=e.split("=")[0],s=decodeURIComponent(e.split("=")[1]);t[r]=s})),t}},{key:"seriesQueryParam",value:function(e){var t="";if(e){var r=[];Object.keys(e).forEach((function(t){e[t]&&r.push(t+"="+encodeURIComponent(e[t]))})),t=r.join("&")}return t}},{key:"md5String",value:function(e){return u.a.MD5(e).toString()}},{key:"isValidCodeValid",value:function(e){var t,r=new Array({pass:!0,tip:""},{pass:!1,tip:"\u8eab\u4efd\u8bc1\u53f7\u7801\u4f4d\u6570\u4e0d\u5bf9\uff01"},{pass:!1,tip:"\u8eab\u4efd\u8bc1\u53f7\u7801\u51fa\u751f\u65e5\u671f\u8d85\u51fa\u8303\u56f4\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26\uff01"},{pass:!1,tip:"\u8eab\u4efd\u8bc1\u53f7\u7801\u6821\u9a8c\u9519\u8bef\uff01"},{pass:!1,tip:"\u8eab\u4efd\u8bc1\u53f7\u7801\u4e2d\u5730\u533a\u7f16\u7801\u4e0d\u6b63\u786e\uff01"}),s=new Array;if(s=e.split(""),15!=e.length&&18!=e.length)return r[1];if("000000"==e.substr(0,6)||"111111"==e.substr(0,6)||"222222"==e.substr(0,6)||"333333"==e.substr(0,6)||"444444"==e.substr(0,6)||"555555"==e.substr(0,6)||"666666"==e.substr(0,6)||"777777"==e.substr(0,6)||"888888"==e.substr(0,6)||"999999"==e.substr(0,6))return r[4];if("123456"==e.substr(0,6)||"234567"==e.substr(0,6)||"345678"==e.substr(0,6)||"456789"==e.substr(0,6)||"567890"==e.substr(0,6)||"012345"==e.substr(0,6)||"543210"==e.substr(0,6)||"432109"==e.substr(0,6)||"321098"==e.substr(0,6)||"210987"==e.substr(0,6)||"109876"==e.substr(0,6)||"098765"==e.substr(0,6)||"987654"==e.substr(0,6)||"876543"==e.substr(0,6)||"765432"==e.substr(0,6))return r[4];if("121212"==e.substr(0,6)||"131313"==e.substr(0,6)||"141414"==e.substr(0,6)||"151515"==e.substr(0,6)||"161616"==e.substr(0,6)||"171717"==e.substr(0,6)||"181818"==e.substr(0,6)||"191919"==e.substr(0,6)||"101010"==e.substr(0,6))return r[4];if("212121"==e.substr(0,6)||"232323"==e.substr(0,6)||"242424"==e.substr(0,6)||"252525"==e.substr(0,6)||"262626"==e.substr(0,6)||"272727"==e.substr(0,6)||"282828"==e.substr(0,6)||"292929"==e.substr(0,6)||"202020"==e.substr(0,6))return r[4];if("313131"==e.substr(0,6)||"323232"==e.substr(0,6)||"343434"==e.substr(0,6)||"353535"==e.substr(0,6)||"363636"==e.substr(0,6)||"373737"==e.substr(0,6)||"383838"==e.substr(0,6)||"393939"==e.substr(0,6)||"303030"==e.substr(0,6))return r[4];if("414141"==e.substr(0,6)||"424242"==e.substr(0,6)||"434343"==e.substr(0,6)||"454545"==e.substr(0,6)||"464646"==e.substr(0,6)||"474747"==e.substr(0,6)||"484848"==e.substr(0,6)||"494949"==e.substr(0,6)||"404040"==e.substr(0,6))return r[4];if("515151"==e.substr(0,6)||"525252"==e.substr(0,6)||"535353"==e.substr(0,6)||"545454"==e.substr(0,6)||"565656"==e.substr(0,6)||"575757"==e.substr(0,6)||"585858"==e.substr(0,6)||"595959"==e.substr(0,6)||"505050"==e.substr(0,6))return r[4];if("616161"==e.substr(0,6)||"626262"==e.substr(0,6)||"636363"==e.substr(0,6)||"646464"==e.substr(0,6)||"656565"==e.substr(0,6)||"676767"==e.substr(0,6)||"686868"==e.substr(0,6)||"696969"==e.substr(0,6)||"606060"==e.substr(0,6))return r[4];if("717171"==e.substr(0,6)||"727272"==e.substr(0,6)||"737373"==e.substr(0,6)||"747474"==e.substr(0,6)||"757575"==e.substr(0,6)||"767676"==e.substr(0,6)||"787878"==e.substr(0,6)||"797979"==e.substr(0,6)||"707070"==e.substr(0,6))return r[4];if("818181"==e.substr(0,6)||"828282"==e.substr(0,6)||"838383"==e.substr(0,6)||"848484"==e.substr(0,6)||"858585"==e.substr(0,6)||"868686"==e.substr(0,6)||"878787"==e.substr(0,6)||"898989"==e.substr(0,6)||"808080"==e.substr(0,6))return r[4];if("919191"==e.substr(0,6)||"929292"==e.substr(0,6)||"939393"==e.substr(0,6)||"949494"==e.substr(0,6)||"959595"==e.substr(0,6)||"969696"==e.substr(0,6)||"979797"==e.substr(0,6)||"989898"==e.substr(0,6)||"909090"==e.substr(0,6))return r[4];if(null=={11:"\u5317\u4eac",12:"\u5929\u6d25",13:"\u6cb3\u5317",14:"\u5c71\u897f",15:"\u5185\u8499\u53e4",21:"\u8fbd\u5b81",22:"\u5409\u6797",23:"\u9ed1\u9f99\u6c5f",31:"\u4e0a\u6d77",32:"\u6c5f\u82cf",33:"\u6d59\u6c5f",34:"\u5b89\u5fbd",35:"\u798f\u5efa",36:"\u6c5f\u897f",37:"\u5c71\u4e1c",41:"\u6cb3\u5357",42:"\u6e56\u5317",43:"\u6e56\u5357",44:"\u5e7f\u4e1c",45:"\u5e7f\u897f",46:"\u6d77\u5357",50:"\u91cd\u5e86",51:"\u56db\u5ddd",52:"\u8d35\u5dde",53:"\u4e91\u5357",54:"\u897f\u85cf",61:"\u9655\u897f",62:"\u7518\u8083",63:"\u9752\u6d77",64:"\u5b81\u590f",65:"\u65b0\u7586",71:"\u53f0\u6e7e",81:"\u9999\u6e2f",82:"\u6fb3\u95e8",91:"\u56fd\u5916"}[parseInt(e.substr(0,2))])return r[4];switch(e.length){case 15:return((parseInt(e.substr(6,2))+1900)%4==0||(parseInt(e.substr(6,2))+1900)%100==0&&(parseInt(e.substr(6,2))+1900)%4==0?/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/:/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/).test(e)?r[0]:r[2];case 18:return(parseInt(e.substr(6,4))%4==0||parseInt(e.substr(6,4))%100==0&&parseInt(e.substr(6,4))%4==0?/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/:/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/).test(e)?(t=7*(parseInt(s[0])+parseInt(s[10]))+9*(parseInt(s[1])+parseInt(s[11]))+10*(parseInt(s[2])+parseInt(s[12]))+5*(parseInt(s[3])+parseInt(s[13]))+8*(parseInt(s[4])+parseInt(s[14]))+4*(parseInt(s[5])+parseInt(s[15]))+2*(parseInt(s[6])+parseInt(s[16]))+1*parseInt(s[7])+6*parseInt(s[8])+3*parseInt(s[9]),"F","10X98765432","10X98765432".substr(t%11,1)==s[17]?r[0]:r[3]):r[2];default:return r[1]}}}]),t}();c.filterParams=function(e){for(var t in e)(!e[t]&&0!==e[t]||""===e[t].toString().replace(/(^\s*)|(\s*$)/g,""))&&delete e[t];return e},c.isWeiXin=function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)}}).call(this,r(18))},248:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var s=r(158),n=r(159),a=function(){function e(){Object(s.a)(this,e)}return Object(n.a)(e,null,[{key:"save",value:function(e,t){sessionStorage.setItem(e,JSON.stringify(t))}},{key:"load",value:function(e){var t=sessionStorage.getItem(e);return t&&"undefined"!==t?JSON.parse(t):{}}},{key:"delete",value:function(e){sessionStorage.removeItem(e)}},{key:"clear",value:function(){sessionStorage.clear()}},{key:"saveLocal",value:function(e,t){localStorage.setItem(e,JSON.stringify(t))}},{key:"loadLocal",value:function(e){var t=localStorage.getItem(e);return t?JSON.parse(t):null}}]),e}()},264:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return o}));var s=r(158),n=r(159),a=r(170),u=r(248),i=r(362),o=function(){function t(){Object(s.a)(this,t)}return Object(n.a)(t,null,[{key:"uploadRequest",value:function(e,t,r){var s=e.indexOf("http")>=0?e:Object(i.getServiceURL)()+e,n={};n.Authorization="Bearer "+u.a.load("token");var o=new FormData;if(o.append("file",t),r=a.a.filterParams(r)){var c=[];Object.keys(r).forEach((function(e){return c.push(e+"="+encodeURIComponent(r[e]))})),s+="?"+c.join("&")}return new Request(s,{headers:n,method:"POST",body:o})}},{key:"seriesRequest",value:function(t,r){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a="".concat(Object(i.getServiceURL)()).concat(r);r.includes("http")&&(a=r);var o,c=e.token?e.token:u.a.load("token");if(n["Content-Type"]="application/json;charset=utf-8",n.Authorization="Bearer "+c,"GET"===t||"DELETE"===t){var f=[];Object.keys(s).forEach((function(e){return f.push(e+"="+encodeURIComponent(s[e]))})),f.length>0&&(a+="?"+f.join("&")),o=new Request(a,{method:t,headers:n})}else if("GETF"===t){var b=[];Object.keys(s).forEach((function(e){return b.push(e+"="+encodeURIComponent(s[e]))})),b.length>0&&(a+="?"+b.join("&")),o=new Request(a,{method:"GET",headers:n,credentials:"include"})}else{var l=JSON.stringify(s);"POST"===t?o=new Request(a,{method:"POST",headers:n,body:l}):"PUT"===t?o=new Request(a,{method:"PUT",headers:n,body:l}):"PUTF"===t?o=new Request(a,{method:"PUT",headers:n,credentials:"include",body:l}):"POSTF"===t&&(o=new Request(a,{method:"POST",headers:n,body:l,credentials:"include"}))}return o}}]),t}()}).call(this,r(18))},265:function(e,t,r){"use strict";r(158),r(159)},270:function(e,t){},272:function(e,t){},282:function(e,t){},284:function(e,t){},311:function(e,t){},312:function(e,t){},317:function(e,t){},319:function(e,t){},326:function(e,t){},345:function(e,t){},362:function(e,t,r){var s="";e.exports={getServiceURL:function(){return s}}},366:function(e,t,r){"use strict";var s=r(264),n=(r(194),r(195)),a=r.n(n),u=r(158),i=r(159),o=r(170),c=function(){function e(){Object(u.a)(this,e)}return Object(i.a)(e,null,[{key:"handleRequest",value:function(e,t){return"arrayBuffer"===t?fetch(e):fetch(e).then((function(e){if(e.status>=200&&e.status<=300)return e.json();throw e})).then((function(e){return 200!=e.code&&a.a.info(e.msg,1),e})).catch((function(e){if("TypeError: Failed to fetch"!=e&&"SyntaxError: Unexpected end of JSON input"!=e){var t="\u8bf7\u6c42\u5931\u8d25";return 401===e.status?t="\u6388\u6743\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u9646":500===e.status?t="\u670d\u52a1\u8bf7\u6c42\u5f02\u5e38":403===e.status?t="\u63a5\u53e3\u7981\u6b62\u8bbf\u95ee":404===e.status?t="\u670d\u52a1\u4e0d\u5b58\u5728":e.status>=400&&e.status<500&&(t="\u8bf7\u6c42\u6570\u636e\u683c\u5f0f\u9519\u8bef"),a.a.info(t,1),401===e.status&&setTimeout((function(){var e=location.hash,t=o.a.parseQueryParam(e);location.hash="login?".concat(o.a.seriesQueryParam(t))}),1e3),{code:e.status}}a.a.info("\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u540e\u5237\u65b0\u91cd\u8bd5",1)}))}}]),e}(),f={login:function(e,t){var r=s.a.seriesRequest("GET","/api/efilm/report/verify/".concat(e),t);return c.handleRequest(r)},fetchMedicalRecords:function(e,t){var r=s.a.seriesRequest("GET","/api/efilm/report/all",t);return c.handleRequest(r)},fetchReportDetail:function(){var e=s.a.seriesRequest("GET","/api/efilm/report");return c.handleRequest(e)},fetchShareCode:function(e,t){var r=s.a.seriesRequest("GET","/api/efilm/share/code",t);return c.handleRequest(r)},fetchReportInfoBySharecode:function(e,t){var r=s.a.seriesRequest("GET","/api/efilm/share/info/".concat(e),t);return c.handleRequest(r)},fetchShareVerification:function(e){var t=s.a.seriesRequest("GET","/api/efilm/share/check/".concat(e));return c.handleRequest(t)},fetchOpenDicomMethod:function(){var e=s.a.seriesRequest("GET","/api/efilm/report/openpath");return c.handleRequest(e)},fetchConfigWithReportUUID:function(e){var t=s.a.seriesRequest("GET","/api/efilm/report/check/report/".concat(e));return c.handleRequest(t)},fetchConfigWidthCode:function(e){var t=s.a.seriesRequest("GET","/api/sys/institution/efilm_config",e);return c.handleRequest(t)},loginWithInstitutionCode:function(e){var t=s.a.seriesRequest("GET","/api/efilm/report/institution/verify",e);return c.handleRequest(t)},loginWithReportUUID:function(e){var t=s.a.seriesRequest("GET","/api/efilm/report/report/verify",e);return c.handleRequest(t)},fetchReportPdf:function(e){var t=s.a.seriesRequest("GET","/api/efilm/report/pdf",e);return c.handleRequest(t)}};t.a=f},75:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"default",(function(){return g}));r(72),r(49),r(249);var s=r(252),n=r.n(s),a=(r(365),r(194),r(195)),u=r.n(a),i=r(261),o=r.n(i),c=r(263),f=r(364),b=r(0),l=r(1),d=(r(68),r(366)),h=r(248),p=r(170),v=r(3);function g(e){var t=Object(b.useState)(1==h.a.load("efilmAgreeVisible")),r=Object(f.a)(t,2),s=r[0],a=(r[1],Object(b.useState)(1==h.a.load("efilmAgreeFlag"))),i=Object(f.a)(a,2),g=i[0],m=(i[1],Object(b.useState)(!1)),y=Object(f.a)(m,2),O=y[0],j=y[1],R=Object(b.useState)(!1),k=Object(f.a)(R,2),S=(k[0],k[1]),I=Object(b.useState)({}),w=Object(f.a)(I,2),C=w[0],q=w[1],E=Object(b.useState)({}),x=Object(f.a)(E,2),T=(x[0],x[1]),_=Object(b.useState)(h.a.load("efilmInputDic0")),P=Object(f.a)(_,2),U=P[0],A=P[1],G=Object(b.useState)([]),D=Object(f.a)(G,2),N=(D[0],D[1]),J=Object(b.useState)(""),M=Object(f.a)(J,2),F=M[0],L=M[1],V=Object(l.f)(),W=p.a.parseQueryParam(location.hash),B=Object(b.useRef)(g),Q=Object(b.useRef)(s),X=W.institution_code,$=void 0===X?"":X,z=W.report_uuid,Y=void 0===z?"":z,H=W.share_code;Object(b.useEffect)((function(){document.title="\u6570\u5b57\u80f6\u7247\u8eab\u4efd\u6838\u9a8c"}),[]),Object(b.useEffect)((function(){B.current=g}),[g]),Object(b.useEffect)((function(){Q.current=s}),[s]),Object(b.useEffect)((function(){if(!p.a.isEmptyObj(C)&&F){var e=C.efilm_config,t=(void 0===e?{}:e).verify_way,r=void 0===t?{}:t,s=h.a.load("efilmInputDic".concat(F)),n=r[F],a={};Object.keys(n).forEach((function(e){a[e]=s[e]?s[e]:""})),A(a)}}),[F,C]),Object(b.useEffect)(Object(c.a)(o.a.mark((function e(){var t,r,s,n,a,u,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},!$){e.next=7;break}return e.next=4,d.a.fetchConfigWidthCode({institution_code:$});case 4:t=e.sent,e.next=28;break;case 7:if(!Y){e.next=13;break}return e.next=10,d.a.fetchConfigWithReportUUID(Y);case 10:t=e.sent,e.next=28;break;case 13:if(!H){e.next=28;break}return e.next=16,d.a.fetchShareVerification(H);case 16:if(200!==(t=e.sent).code){e.next=25;break}if(1==t.data.need_verify){e.next=21;break}return K(),e.abrupt("return");case 21:A({verify_code:""}),q(t.data),e.next=26;break;case 25:T({message:t.msg?t.msg:"\u5f53\u524d\u62a5\u544a\u4e0d\u5b58\u5728\u6216\u5206\u4eab\u7801\u5df2\u5931\u6548"});case 26:return S(!0),e.abrupt("return");case 28:if(200!=t.code){e.next=41;break}if(r=t.data.efilm_config,n=(s=void 0===r?{}:r).verify_way,a=void 0===n?{}:n,u=s.report_show,void 0===u?"":u,0!=s.is_turn_efilm){e.next=34;break}return T({message:t.msg?t.msg:"\u6570\u5b57\u80f6\u7247\u670d\u52a1\u672a\u5f00\u542f"}),e.abrupt("return");case 34:i=Object.keys(a).sort((function(e,t){return e-t})),c=sessionStorage.getItem("selectedVerifyWay"),L(c||i[0]),N(i),q(t.data),e.next=42;break;case 41:T({message:t.msg?t.msg:"\u62a5\u544a\u4e0d\u5b58\u5728\uff0c\u8bf7\u6838\u5bf9\u9a8c\u8bc1\u4fe1\u606f"});case 42:S(!0);case 43:case"end":return e.stop()}}),e)}))),[]);var K=function(){j(!0);var e=U.verify_code;d.a.fetchReportInfoBySharecode(H,{verify_code:e}).then((function(e){if(j(!1),200==e.code){var t={is_anony:e.data.is_anony,is_show_history:e.data.is_show_history,share_code:H};h.a.save("shareData",t),h.a.save("token",e.data.token),V.push("/report?report_uuid=".concat(e.data.report_uuid))}else u.a.info("\u9a8c\u8bc1\u7801\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165",1)}))},Z=function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.location.href="http://58.213.167.22:8087/pdf-report/ff07c05b-682d-44be-b256-bfe1f1d04c5c@NJMJYY631@2969405.pdf";case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsx)(n.a,{className:"validate_btn",loading:O,onClick:Z,style:{margin:"0"},children:"\u9a8c\u8bc1"})}}.call(this,r(18))}}]);